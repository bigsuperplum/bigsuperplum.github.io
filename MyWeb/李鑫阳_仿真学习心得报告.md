# 仿真学习心得报告

## 学习过程及收获

在跟随 AirHust 团队学习之前，我曾使用过 VMWare 虚拟机，但主要用于装 Windows 系统，对 Linux 系统一无所知。

所以我的第一个收获应该是熟悉了 Linux 系统的操作和使用。我跟随着讲义，逐步在命令行里执行指令，观察其能起到的效果。虽然我依旧习惯于在 GUI 上戳戳点点，但我意识到了命令行简洁而迅速的优势，并开始摆脱对它的依赖。在学习中，我掌握了一些常用指令，如 cd, mkdir, ls, cp, rm 等，同时也学会了运用 sudo 以管理员模式更新文件，用 gedit 修改文件，以及用 git clone 从 github 下载代码库。

我的第二个收获是了解了 ROS 架构。在后续的学习中，我多建了几个工作环境，以及其下属的更多的功能包。为了厘清各个文件及文件夹的作用，我从网络上了解了 workspace 及 package 的组成。

![img](http://www.autolabor.com.cn/book/ROSTutorials/assets/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.jpg)

我了解到 src 是代码的存放地，而 devel 则用来存储可执行文件。package 下 CMakeLists.txt 是编译用到的文件，package.xml 标明了功能包的真实名称（而不是文件夹名），等等。

## 困难与解决方法

1、报错：neither ... nor ... 及 connot find px4

这两个应该算是比较经典的报错，是使用 launch 文件打开多个节点时产生的。我先自主检查了工作空间是否有文件缺失，不过并没有发现问题。于是我询问 AI 报错的由来，并根据 AI 的指示操作，但最后又出现了另一种报错。我便安装了一个新的虚拟机，从头开始进行配置，最终成功运行。但这并不算真正地解决问题，于是我尝试求助学长，最终得到了解决方案：在进行完修改操作后，首先需要 catkin_make 进行编译，然后需要更新环境变量，比如把 source bash 文件的指令加入 .bashrc 文件中，每次打开命令行后都会重新启用。

这个过程中，我采取了先独立解决，再询问 AI，后询问学长的方式。有时我发现，虽然 AI 功能强大，但不一定能有针对性地解决每个人的问题。或许需要提供更多的提示词，但最终仍然需要自己理解。

2、完成梯队任务时，不理解 ROS 提供的函数如何使用，看不懂给的示例代码

这其实算一个大坑，我尝试将其分解成若干个小任务。比如：我遇到了 ros::Duration，我会先在网络上查找它的含义。大致理解后，我会尝试对其进行改动，比如修改一些名称和参数，以验证我的理解是否正确。接下来，我会将其运用到我自己写的代码当中，以实现真正掌握。

目前遇到的比较困难的示例代码是避障时用到的人工势场法。我在独立开发时，很难读下来，但在与队友讨论后，发现可以分成几个部分，逐一攻克。我也感受到了与伙伴共同完成任务的重要性。

## 仿真演示

飞行环境：empty.world

模型：iris_rplidar

任务：使无人机的飞行航迹呈现出一个心形

逻辑：

1、设定一个等待时间，在这段时间内，无人机将起飞；

2、起飞后，程序进入画心形的部分，实际演示中轨迹有重叠，即画了一个多一点心形

3、设定一个等待时间，在这段时间内，无人机将返回；

4、无人机降落。

其中，画心形的部分用到了心形的参数方程。通过遍历角度值，我们可以实现对图形的细分，让轨迹更加圆滑。实际演示中未标记轨迹，但可看出是一个爱心。

主要代码展示：

```cpp
    ros::Duration du(0.01);
	int comid = 0;
    for (float angle = 0.0; angle < M_PI * 2.5; angle += 0.001){
        float x = pow(sinf(angle), 3) / 2.0;
        float y = (13 * cosf(angle) - 5 * cosf(2.0*angle) - 2 * cosf(3.0*angle) - cosf(4.0*angle)) / 32.0;
        Command_now.command = Move_ENU;
        Command_now.sub_mode = 0;
        Command_now.pos_sp[0] = x;
        Command_now.pos_sp[1] = y;
        Command_now.pos_sp[2] = height_square;
        Command_now.yaw_sp = 0;
        Command_now.comid = comid;
        comid++;
        du.sleep();
        move_pub.publish(Command_now);
        cout << "Point 1----->love" << endl;
    }
```



